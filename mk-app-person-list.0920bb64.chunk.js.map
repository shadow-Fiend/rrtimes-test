{"version":3,"sources":["webpack:///./apps/person/list/component.js","webpack:///./apps/person/list/action.js","webpack:///./apps/person/list/reducer.js"],"names":["_react","__webpack_require__","_mkMetaEngine","C","wrapper","appInfo","this","props","monkeyKing","_extends3","default","path","Component","option","metaAction","MetaAction","o","action","ret","config","metaHandlers","_this","_classCallCheck3","onInit","_ref","component","injections","reduce","pagination","gf","toJS","load","_ref2","_asyncToGenerator3","_regenerator2","mark","_callee","response","filter","arguments","length","undefined","wrap","_context","prev","next","webapi","person","query","sent","stop","_x","apply","getListRowsCount","size","isSelectAll","lst","every","get","selectAll","e","target","checked","pageChanged","current","pageSize","reportChange","report","value","urlChange","v","url","getDateRange","dateRange","dateRangeChange","dates","clearFilter","refresh","editRow","_ref3","_callee2","_len","args","Array","_key","_args$pop","rowIndex","row","_context2","pop","apps","modal","title","children","loadApp","store","personId","id","isPop","metaReducer","MetaReducer","reducer","_immutable","_data","init","state","initState","getInitState","sf","fromJS","list","i"],"mappings":"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","file":"mk-app-person-list.0920bb64.chunk.js","sourcesContent":["import React, { Component } from 'react'\nimport { wrapper } from 'mk-meta-engine'\nimport appInfo from './index'\n\n@wrapper(appInfo)\nexport default class C extends Component {\n\trender() {\n\t\treturn this.props.monkeyKing({ ...this.props, path: 'root' })\n\t}\n}","import React from 'react'\nimport { action as MetaAction, AppLoader } from 'mk-meta-engine'\nimport { fromJS } from 'immutable'\nimport config from './config'\nimport moment from 'moment'\n\nclass action {\n    constructor(option) {\n        this.metaAction = option.metaAction\n        this.config = config.current\n        this.webapi = this.config.webapi\n    }\n\n    onInit = ({ component, injections }) => {\n        this.component = component\n        this.injections = injections\n        injections.reduce('init')\n\n        const pagination = this.metaAction.gf('data.pagination').toJS()\n        this.load(pagination)\n    }\n\n    load = async (pagination, filter = {}) => {\n        const response = await this.webapi.person.query({ pagination, filter })\n        response.filter = filter\n        this.injections.reduce('load', response)\n    }\n\n    getListRowsCount = () => {\n        return this.metaAction.gf('data.list').size\n    }\n\n    isSelectAll = () => {\n        const lst = this.metaAction.gf('data.list')\n        if (!lst || lst.size == 0)\n            return false\n\n        return lst.every(o => o.get('selected'))\n    }\n\n    selectAll = (e) => {\n        this.injections.reduce('selectAll', e.target.checked)\n    }\n\n    pageChanged = (current, pageSize) => {\n        const filter = this.metaAction.gf('data.filter').toJS()\n        this.load({ current, pageSize }, filter)\n    }\n\n    reportChange = (e) => {\n        const pagination = this.metaAction.gf('data.pagination').toJS(),\n            filter = this.metaAction.gf('data.filter').toJS()\n\n        filter.report = e.target.value\n        this.load(pagination, filter)\n    }\n\n    urlChange = (v) => {\n        const pagination = this.metaAction.gf('data.pagination').toJS(),\n            filter = this.metaAction.gf('data.filter').toJS()\n\n        filter.url = v\n        this.load(pagination, filter)\n    }\n\n    getDateRange = () => {\n        const dateRange = this.metaAction.gf('data.filter.dateRange')\n        if (dateRange) {\n            return dateRange.toJS()\n        }\n    }\n\n    dateRangeChange = (dates) => {\n        const pagination = this.metaAction.gf('data.pagination').toJS(),\n            filter = this.metaAction.gf('data.filter').toJS()\n\n        filter.dateRange = dates\n        this.load(pagination, filter)\n    }\n\n    clearFilter = () => {\n        const pagination = this.metaAction.gf('data.pagination').toJS(),\n            filter = {}\n        this.load(pagination, filter)\n    }\n\n    refresh = () => {\n        const pagination = this.metaAction.gf('data.pagination').toJS(),\n            filter = this.metaAction.gf('data.filter').toJS()\n\n        this.load(pagination, filter)\n    }\n\n    editRow = async (...args) => {\n        const { rowIndex } = args.pop()\n        const row = this.metaAction.gf(`data.list.${rowIndex}`).toJS()\n        \n        if(!this.config.apps['mk-app-person-card']){\n            throw '依赖mk-app-person-card app,请使用mk clone mk-app-person-card命令添加'\n        }\n\n        const ret = await this.metaAction.modal('show', {\n            title: '人员',\n            children: this.metaAction.loadApp('mk-app-person-card?from=list', {\n                store: this.component.props.store,\n                personId: row.id,\n                isPop:true\n            })\n        })\n\n        if (ret) {\n            this.refresh()\n        }\n    }\n\n}\n\nexport default function creator(option) {\n    const metaAction = new MetaAction(option),\n        o = new action({ ...option, metaAction }),\n        ret = { ...metaAction, ...o }\n\n    metaAction.config({ metaHandlers: ret })\n\n    return ret\n}","import { Map, fromJS } from 'immutable'\nimport { reducer as MetaReducer } from 'mk-meta-engine'\nimport config from './config'\nimport { getInitState } from './data'\n\nclass reducer {\n    constructor(option) {\n        this.metaReducer = option.metaReducer\n    }\n\n    init = (state, option) => {\n        const initState = getInitState()\n        return this.metaReducer.init(state, initState)\n\n    }\n\n    load = (state, response) => {\n        state = this.metaReducer.sf(state, 'data.list', fromJS(response.list))\n        state = this.metaReducer.sf(state, 'data.pagination', fromJS(response.pagination))\n        state = this.metaReducer.sf(state, 'data.filter', fromJS(response.filter))\n        return state\n    }\n\n    selectAll = (state, checked) => {\n        var lst = this.metaReducer.gf(state, 'data.list')\n\n        if (!lst || lst.size == 0)\n            return state\n\n        for (let i = 0; i < lst.size; i++) {\n            state = this.metaReducer.sf(state, `data.list.${i}.selected`, checked)\n        }\n\n        return state\n    }\n\n\n}\n\nexport default function creator(option) {\n    const metaReducer = new MetaReducer(option),\n        o = new reducer({ ...option, metaReducer })\n\n    return { ...metaReducer, ...o }\n}"],"sourceRoot":""}